# Drop City Landing (dropcity.io)

Static landing page deployed on Vercel.

## Beta signup API

This repo includes a Vercel Serverless Function:

- `POST /api/beta-signup`

### Environment variables (Vercel)

Set these in your Vercel project settings:

- `SUPABASE_URL`
- `SUPABASE_SERVICE_ROLE_KEY` (server-only)
- `RESEND_API_KEY` (optional; for notifications)
- `NOTIFY_EMAIL` (optional; where to send notifications)

### Supabase table

Create a table for signups (idempotent on `email`):

```sql
create table if not exists public.beta_signups (
  id bigint generated by default as identity primary key,
  email text not null,
  source text,
  ip text,
  user_agent text,
  created_at timestamptz not null default now(),
  updated_at timestamptz not null default now(),
  constraint beta_signups_email_key unique (email)
);

-- Optional: keep updated_at fresh automatically
create or replace function public.set_updated_at()
returns trigger as $$
begin
  new.updated_at = now();
  return new;
end;
$$ language plpgsql;

drop trigger if exists beta_signups_set_updated_at on public.beta_signups;
create trigger beta_signups_set_updated_at
before update on public.beta_signups
for each row execute procedure public.set_updated_at();
```

### Local testing

You can run the static site locally:

```bash
npm install
npm run dev
```

Note: `npm run dev` uses `serve` and does **not** run Vercel functions.

To test the serverless function locally, use the Vercel CLI:

```bash
npm i -g vercel
vercel dev
```

Then in another shell:

```bash
curl -i \
  -X POST http://localhost:3000/api/beta-signup \
  -H 'Content-Type: application/json' \
  -d '{"email":"test@example.com"}'
```

Expected: `200` with JSON `{ ok: true, ... }`.
